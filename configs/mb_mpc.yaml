experiment_name: mbmpc_halfcheetah_v3_nagabandi
algo: mb_mpc_nagabandi
env: HalfCheetahCustom-v0
seed: 42  # Added for Nagabandi fidelity

train:
  total_iterations: 50           # Nagabandi n_itr
  init_random_steps: 1000        # ~10 rollouts × 100 steps (itr=0)
  rollout_steps: 1000            # ~10 rollouts × 100 steps per itr
  epochs: 100                    # max epochs; early stopping enabled

  # Dynamics + planner hyperparameters
  hidden_sizes: [512, 512]
  lr: 0.001
  batch_size: 128                # Nagabandi batch size
  val_ratio: 0.1                 # Nagabandi validation split
  device: cuda

  # Added for Nagabandi fidelity
  planner_type: rs           # options: rs, cem
  early_stop_patience: 5     # stop if no EMA improvement for 5 epochs
  rolling_average_persitency: 0.99

  # RS settings matching Nagabandi
  horizon: 20
  n_candidates: 256
  # Planner options
  clip_rollouts: false     # clip actions during rollouts (original used unclipped)

  n_envs: 2                      # Nagabandi used 2 parallel envs

eval:
  episodes: 1
  seeds: [0, 1, 2, 3, 4, 5]
  deterministic: true
  save_csv: true
